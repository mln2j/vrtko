////  GardenListView.swift//  Vrtko////  Created by Mihael Lendvaj on 31.05.2025..//import SwiftUIstruct GardenListView: View {    @StateObject private var gardenRepo = GardenRepository()    @StateObject private var locationManager = LocationManager()    @EnvironmentObject var authService: AuthService    @State private var showingAddGarden = false    var body: some View {        NavigationView {            List {                ForEach(filteredGardens) { garden in                    NavigationLink(destination: GardenDetailView(garden: garden, gardenRepo: gardenRepo)) {                        HStack {                            VStack(alignment: .leading, spacing: 4) {                                Text(garden.name)                                    .font(.headline)                                if !garden.description.isEmpty {                                    Text(garden.description)                                        .font(.subheadline)                                        .foregroundColor(.secondary)                                }                            }                            Spacer()                            Image(systemName: garden.isPublic ? "globe" : "lock.fill")                                .foregroundColor(garden.isPublic ? .green : .gray)                                .imageScale(.large)                                .padding(.leading, 8)                        }                        .padding(.vertical, 8)                    }                }                .onDelete(perform: deleteGardens)            }            .listStyle(.insetGrouped)            .navigationTitle("Moji vrtovi")            .navigationBarTitleDisplayMode(.large)            .toolbar {                ToolbarItem(placement: .navigationBarTrailing) {                    Button(action: { showingAddGarden = true }) {                        Image(systemName: "plus")                    }                    .accessibilityLabel("Dodaj vrt")                }            }            .sheet(isPresented: $showingAddGarden) {                AddGardenView(gardenRepo: gardenRepo, locationManager: locationManager)                    .environmentObject(authService)            }            .onAppear {                if let userId = authService.user?.id {                    gardenRepo.fetchGardens(for: userId)                }                // Debug print svih vrtova i njihovih id-eva                for garden in gardenRepo.gardens {                    print("Garden: \(garden.name), id: \(garden.id)")                }            }        }    }        // Filtrirana lista vrtova s ne-nil documentId (koristi se za prikaz i brisanje)    private var filteredGardens: [Garden] {        gardenRepo.gardens.filter { $0.documentId != nil }    }    // Briši iz filtrirane liste, a zatim iz originala    private func deleteGardens(at offsets: IndexSet) {        let gardensToDelete = offsets.map { filteredGardens[$0] }        for garden in gardensToDelete {            Task {                do {                    try await gardenRepo.deleteGarden(garden)                } catch {                    // Ovdje možeš prikazati grešku korisniku ako želiš                }            }            // Ukloni iz originalnog arraya            if let realIndex = gardenRepo.gardens.firstIndex(where: { $0.id == garden.id }) {                gardenRepo.gardens.remove(at: realIndex)            }        }    }}